
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.7">
    
    
      
        <title>SMC - Free60 Wiki archive</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.196e0c26.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-fifo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Free60 Wiki archive" class="md-header-nav__button md-logo" aria-label="Free60 Wiki archive">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Free60 Wiki archive
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              SMC
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Free60 Wiki archive" class="md-nav__button md-logo" aria-label="Free60 Wiki archive">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Free60 Wiki archive
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Category_Xbox360_Hardware/" class="md-nav__link">
      Hardware
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Category_Xbox360_System_Software/" class="md-nav__link">
      System Software
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Category_Xbox360_Homebrew_Software/" class="md-nav__link">
      Homebrew Software
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Category_Xbox360_Linux/" class="md-nav__link">
      Linux
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Category_Xbox360_Development/" class="md-nav__link">
      Development
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Category_Support/" class="md-nav__link">
      Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../%21TODO/" class="md-nav__link">
      ToDo
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-fifo" class="md-nav__link">
    The FIFO
  </a>
  
    <nav class="md-nav" aria-label="The FIFO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sending-a-message" class="md-nav__link">
    Sending a Message
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receiving-a-reply" class="md-nav__link">
    Receiving a Reply
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-messages" class="md-nav__link">
    Command Messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-messages" class="md-nav__link">
    Query Messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-messages" class="md-nav__link">
    Event Messages
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>SMC</h1>
                
                <p>The <strong>System Management Controller (SMC)</strong> is an
<a href="8051_8052" title="wikilink">8051/8052</a> core inside the
<a href="Southbridge" title="wikilink">Southbridge</a>. It manages the power sequencing,
and is always active when the Xbox 360 has (standby or full) power
applied. It controls the frontpanel, has a Realtime clock, decodes IR,
manages temperatures, fans, DVDROM tray and a bunch of other things. It
talks with the frontpanel board to set the LEDs. When the system is
running, the kernel can communicate with the SMC, for example to query
the realtime clock, open the dvd-tray etc.</p>
<h2 id="the-fifo">The FIFO</h2>
<h3 id="sending-a-message">Sending a Message</h3>
<p>Communication between kernel and SMC happens over a bidirectional FIFO
(at ea001080 / ea001090).
All messages and replies are 16 byte long and have the command id in the
first byte.</p>
<p><code></p>
<pre><code>void smc_send(void *msg)
{
      while (!(readl(0xea001084) &amp; 4))    // wait for FIFO ready
              cpu_relax();

      writel(4, 0xea001084);              // start message
      writesl(0xea001080, msg, 4);        // send 16 bytes
      writel(0, 0xea001084);              // end message
}
</code></pre>
<p></code></p>
<h3 id="receiving-a-reply">Receiving a Reply</h3>
<p>Some messages have replies, which will be returned as 16 byte sequence
similar to the message (they also have the command id in the first
byte).</p>
<p><code></p>
<pre><code>int smc_read_reply(void *msg)
{
      if (!(readl(0xea001094) &amp; 4))       // do we have a reply?
              return 0;

      writel(4, 0xea001094);              // start reply
      readsl(0xea001090, msg, 4);         // read 16 bytes
      writel(0, 0xea001094);              // end reply
      return 1;
}
</code></pre>
<p></code></p>
<h2 id="command-messages">Command Messages</h2>
<table>
<thead>
<tr>
<th>ID</th>
<th>Len</th>
<th>Example</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="SMC_Command_0x82" title="wikilink">0x82</a></td>
<td>2-3</td>
<td>"\x82\0x04\0x31\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set standby/power</td>
</tr>
<tr>
<td>0x85</td>
<td>?</td>
<td>?</td>
<td>set real time clock</td>
</tr>
<tr>
<td>0x88</td>
<td>?</td>
<td>?</td>
<td>set fan algorithm</td>
</tr>
<tr>
<td>0x89</td>
<td>?</td>
<td>?</td>
<td>set fan speed (cpu/gpu?)</td>
</tr>
<tr>
<td>0x8b</td>
<td>?</td>
<td>"\x8b\0x62\0x00\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set dvd tray</td>
</tr>
<tr>
<td>0x8c</td>
<td>3</td>
<td>"\x8c\0x01\0x00\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set power led</td>
</tr>
<tr>
<td>0x8d</td>
<td>2</td>
<td>"\x8d\0x01\0x00\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set audio mute</td>
</tr>
<tr>
<td>0x94</td>
<td>?</td>
<td>?</td>
<td>set fan speed (cpu/gpu?)</td>
</tr>
<tr>
<td>0x95</td>
<td>?</td>
<td>?</td>
<td>set ir address</td>
</tr>
<tr>
<td>0x98</td>
<td>1</td>
<td>"\x98\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set dvd tray secure</td>
</tr>
<tr>
<td>0x99</td>
<td>3</td>
<td>"\x99\0x01\0x0f\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set ring of light</td>
</tr>
<tr>
<td>0x9a</td>
<td>?</td>
<td>?</td>
<td>set rtc wake</td>
</tr>
</tbody>
</table>
<h2 id="query-messages">Query Messages</h2>
<table>
<thead>
<tr>
<th>ID</th>
<th>Len</th>
<th>Example Query</th>
<th>Example Reply</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="SMC_Command_0x01" title="wikilink">0x01</a></td>
<td>1:6</td>
<td>"\x01\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>01 12 00 00 00 00</code></td>
<td>power on type</td>
</tr>
<tr>
<td>0x04</td>
<td>1:11</td>
<td>"\x04\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>04 602f 212223 01 00000000</code></td>
<td>real time clock</td>
</tr>
<tr>
<td>0x07</td>
<td>1:10</td>
<td>"\x07\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>07ff 241b 2fa4 2cfa 262c</code></td>
<td>read temps</td>
</tr>
<tr>
<td>0x0a</td>
<td>1:2</td>
<td>"\x0a\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>0a 60</code></td>
<td>request tray state</td>
</tr>
<tr>
<td>0x0f</td>
<td>1:2</td>
<td>"\x0f\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>0f 54</code></td>
<td>request AV pack type</td>
</tr>
<tr>
<td>0x11</td>
<td>6:2</td>
<td>"\x11\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>11 02</code></td>
<td>read ana</td>
</tr>
<tr>
<td>0x12</td>
<td>1:6</td>
<td>"\x12\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>1241 0203 0000</code></td>
<td>request SMC version</td>
</tr>
<tr>
<td>0x16</td>
<td>1:2</td>
<td>"\x16\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>16 0f</code></td>
<td>query IR address</td>
</tr>
<tr>
<td>0x17</td>
<td>1:2</td>
<td>"\x17\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>17 00</code></td>
<td>query tilt sensor</td>
</tr>
</tbody>
</table>
<h2 id="event-messages">Event Messages</h2>
<table>
<thead>
<tr>
<th>ID</th>
<th>Len</th>
<th>Example Message</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x83</td>
<td>2</td>
<td><code>83 64</code></td>
<td>SMC event</td>
</tr>
</tbody>
</table>
<p><a href="Category_Xbox360_Hardware">Category:Xbox360_Hardware</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>